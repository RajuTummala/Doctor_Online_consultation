<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
  body {
    background: #f3f4f6 !important; /* light gray */
    font-family: 'Inter', sans-serif;
  }

  header {
    background: #1f2937 !important; /* dark header */
    color: white !important;
  }

  .sidebar {
    background: #ffffff !important;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1) !important;
  }

  .menu-item {
    background: #ffffff !important;
    border-radius: 10px;
    padding: 12px;
    transition: 0.25s;
  }
  .menu-item:hover {
    background: #e5e7eb !important; /* gray hover */
  }

  button, .btn {
    background: #4f46e5 !important; /* indigo */
    color: white !important;
    border-radius: 8px !important;
    padding: 8px 16px !important;
  }
</style>

</head>

<body class="bg-gray-100">

<!-- HEADER -->
<header class="bg-white shadow">
  <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
    <h1 class="text-xl font-bold">Admin Dashboard</h1>
    <button onclick="logoutAdmin()" class="text-red-500 text-xl">‚éã Logout</button>
  </div>
</header>

<div class="max-w-7xl mx-auto grid grid-cols-12 gap-6 px-6 py-8">

  <!-- SIDEBAR -->
  <aside class="col-span-3 bg-white rounded-xl shadow-lg p-4">
    <h2 class="text-lg font-semibold mb-4">Menu</h2>

    <div class="space-y-2">
      <div class="menu-item" onclick="loadOverview()">üìä Overview</div>
      <div class="menu-item" onclick="loadUserManagement()">üë• User Management</div>
      <div class="menu-item" onclick="loadAppointments()">üìÖ Appointments</div>
      <div class="menu-item" onclick="loadPrescriptionControl()">üìÑ Prescription Control</div>
      <div class="menu-item" onclick="loadSecurity()">üîê Security Monitor</div>
      <div class="menu-item" onclick="loadAnalytics()">üìà Analytics</div>
      <div class="menu-item" onclick="loadSettings()">‚öôÔ∏è Platform Settings</div>
      <div class="menu-item text-red-600" onclick="logoutAdmin()">üö™ Logout</div>
    </div>
  </aside>

  <!-- MAIN CONTENT -->
  <section id="adminMain" class="col-span-9 bg-white shadow-xl p-8 rounded-xl">
    <h2 class="text-2xl font-semibold">Welcome Admin</h2>
    <p class="text-gray-600 mt-2">Select an item from the menu to begin.</p>
  </section>
</div>

<script>

/* ----------------------------------
   GET ALL USERS (Do not modify)
---------------------------------- */
function getAllUsers() {
  let users = [];
  for (let i = 0; i < localStorage.length; i++) {
    let key = localStorage.key(i);
    if (key.startsWith("user_")) {
      users.push(JSON.parse(localStorage.getItem(key)));
    }
  }
  return users;
}

/* ----------------------------------
   1Ô∏è‚É£ OVERVIEW PAGE
---------------------------------- */
function loadOverview() {
  let total = getAllUsers().length;
  let doctors = getAllUsers().filter(u => u.role === "doctor").length;
  let patients = getAllUsers().filter(u => u.role === "patient").length;

  document.getElementById("adminMain").innerHTML = `
    <h2 class="text-2xl font-bold mb-4">üìä Platform Overview</h2>

    <div class="grid grid-cols-3 gap-4">
      <div class="bg-blue-100 p-6 rounded-xl text-center shadow">
        <p>Total Users</p>
        <p class="text-3xl font-bold">${total}</p>
      </div>

      <div class="bg-green-100 p-6 rounded-xl text-center shadow">
        <p>Doctors</p>
        <p class="text-3xl font-bold">${doctors}</p>
      </div>

      <div class="bg-yellow-100 p-6 rounded-xl text-center shadow">
        <p>Patients</p>
        <p class="text-3xl font-bold">${patients}</p>
      </div>
    </div>
  `;
}

/* ----------------------------------
   2Ô∏è‚É£ USER MANAGEMENT
---------------------------------- */
function loadUserManagement() {
  let users = getAllUsers();

  let html = `
    <h2 class="text-2xl font-bold mb-4">üë• User Management</h2>

    <table class="w-full border">
      <tr class="bg-gray-200">
        <th class="border p-2">Name</th>
        <th class="border p-2">Email</th>
        <th class="border p-2">Role</th>
        <th class="border p-2">Action</th>
      </tr>
  `;

  users.forEach(u => {
    html += `
      <tr>
        <td class="border p-2">${u.name}</td>
        <td class="border p-2">${u.email}</td>
        <td class="border p-2">${u.role}</td>
        <td class="border p-2">
          <button onclick="deleteUser('${u.email}')" class="bg-red-600 px-3 py-1 text-white rounded">
            Delete
          </button>
        </td>
      </tr>
    `;
  });

  html += `</table>`;
  document.getElementById("adminMain").innerHTML = html;
}

function deleteUser(email) {
  localStorage.removeItem("user_" + email);
  loadUserManagement();
}

/* ----------------------------------
   3Ô∏è‚É£ PRESCRIPTION CONTROL
---------------------------------- */
function loadPrescriptionControl() {
  let list = JSON.parse(localStorage.getItem("prescriptions") || "[]");

  let html = `
    <h2 class="text-2xl font-bold mb-4">üìÑ Prescription Control</h2>

    <table class="w-full border">
      <tr class="bg-gray-200">
        <th class="border p-2">Doctor</th>
        <th class="border p-2">Patient</th>
        <th class="border p-2">Medicine</th>
        <th class="border p-2">Dosage</th>
        <th class="border p-2">Status</th>
        <th class="border p-2">Actions</th>
      </tr>
  `;

  list.forEach((p, i) => {
    html += `
      <tr>
        <td class="border p-2">${p.doctor}</td>
        <td class="border p-2">${p.patient}</td>
        <td class="border p-2">${p.medicine}</td>
        <td class="border p-2">${p.dosage}</td>
        <td class="border p-2">${p.status}</td>

        <td class="border p-2">
          <button onclick="approvePres(${i})" class="bg-green-600 px-2 py-1 text-white rounded">Approve</button>
          <button onclick="rejectPres(${i})" class="bg-yellow-600 px-2 py-1 text-white rounded">Reject</button>
          <button onclick="deletePres(${i})" class="bg-red-600 px-2 py-1 text-white rounded">Delete</button>
        </td>
      </tr>
    `;
  });

  html += `</table>`;
  document.getElementById("adminMain").innerHTML = html;
}

function approvePres(i) {
  let list = JSON.parse(localStorage.getItem("prescriptions") || "[]");
  list[i].status = "approved";
  localStorage.setItem("prescriptions", JSON.stringify(list));
  loadPrescriptionControl();
}

function rejectPres(i) {
  let list = JSON.parse(localStorage.getItem("prescriptions") || "[]");
  list[i].status = "rejected";
  localStorage.setItem("prescriptions", JSON.stringify(list));
  loadPrescriptionControl();
}

function deletePres(i) {
  let list = JSON.parse(localStorage.getItem("prescriptions") || "[]");
  list.splice(i, 1);
  localStorage.setItem("prescriptions", JSON.stringify(list));
  loadPrescriptionControl();
}

/* ----------------------------------
   4Ô∏è‚É£ SECURITY
---------------------------------- */
function loadSecurity() {
  document.getElementById("adminMain").innerHTML = `
    <h2 class="text-2xl font-bold mb-4">üîê Security Monitor</h2>
    <ul class="space-y-2">
      <li>‚úî No failed logins</li>
      <li>‚úî No hacking attempts</li>
      <li>‚úî All systems normal</li>
    </ul>
  `;
}

/* ----------------------------------
   5Ô∏è‚É£ ANALYTICS
---------------------------------- */
function loadAnalytics() {
  document.getElementById("adminMain").innerHTML = `
    <h2 class="text-2xl font-bold mb-4">üìà Analytics</h2>
    <p>Graphs and charts will appear here.</p>
  `;
}

/* ----------------------------------
    3Ô∏è‚É£ APPOINTMENTS
---------------------------------- */
function loadAppointments() {
  let list = JSON.parse(localStorage.getItem("appointments") || "[]");

  let html = `
    <h2 class="text-2xl font-bold mb-4">üìÖ Appointments</h2>

    <table class="w-full border">
      <tr class="bg-gray-200">
        <th class="border p-2">Patient</th>
        <th class="border p-2">Department</th>
        <th class="border p-2">Date</th>
        <th class="border p-2">Status</th>
        <th class="border p-2">Actions</th>
      </tr>
  `;

  list.forEach((a, i) => {
    html += `
      <tr>
        <td class="border p-2">${a.patient}</td>
        <td class="border p-2">${a.department}</td>
        <td class="border p-2">${a.date}</td>
        <td class="border p-2">${a.status}</td>

        <td class="border p-2">
          <button onclick="approveAppointment(${i})" class="bg-green-600 px-2 py-1 text-white rounded">Approve</button>
          <button onclick="rejectAppointment(${i})" class="bg-yellow-600 px-2 py-1 text-white rounded">Reject</button>
          <button onclick="deleteAppointment(${i})" class="bg-red-600 px-2 py-1 text-white rounded">Delete</button>
        </td>
      </tr>
    `;
  });

  html += `</table>`;
  document.getElementById("adminMain").innerHTML = html;
}

function approveAppointment(i) {
  let list = JSON.parse(localStorage.getItem("appointments") || "[]");
  list[i].status = "approved";
  localStorage.setItem("appointments", JSON.stringify(list));
  loadAppointments();
}

function rejectAppointment(i) {
  let list = JSON.parse(localStorage.getItem("appointments") || "[]");
  list[i].status = "rejected";
  localStorage.setItem("appointments", JSON.stringify(list));
  loadAppointments();
}

function deleteAppointment(i) {
  let list = JSON.parse(localStorage.getItem("appointments") || "[]");
  list.splice(i, 1);
  localStorage.setItem("appointments", JSON.stringify(list));
  loadAppointments();
}

/* ----------------------------------
    4Ô∏è‚É£ PRESCRIPTION CONTROL
---------------------------------- */

/* ----------------------------------
    5Ô∏è‚É£ SECURITY
---------------------------------- */

/* ----------------------------------
    6Ô∏è‚É£ ANALYTICS
---------------------------------- */

/* ----------------------------------
    7Ô∏è‚É£ SETTINGS
---------------------------------- */
function loadSettings() {
  document.getElementById("adminMain").innerHTML = `
    <h2 class="text-2xl font-bold mb-4">‚öôÔ∏è Platform Settings</h2>
    <p>Admin settings will appear here.</p>
  `;
}

/* ----------------------------------
    LOGOUT
---------------------------------- */
function logoutAdmin() {
  alert("Logging out...");
  setTimeout(() => {
    window.location.href = "login.html";
  }, 500);
}

</script>
</body>
</html>
